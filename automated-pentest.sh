#!/usr/bin/env bash

#------------------------------------------------------------------------
# Definindo Constantes
#------------------------------------------------------------------------

# Arquivos 
arquivos='/usr/share/arquivos/'

# Esquema de cores
RED='\033[31;1m'
GREEN='\033[32;1m'
BLUE='\033[34;1m'
YELLOW='\033[33;1m'
RED_BLINK='\033[31;5;1m'
END='\033[m'

# Versao do programa
VERSION='1.0'

#------------------------------------------------------------------------
# Banner
#------------------------------------------------------------------------

echo "###########################################################################"
echo "# [1] - Enumerar SMB/NetBIOS     [6] -                                    #"
echo "# [2] - Enumerar RPC             [7] -                                    #"
echo "# [3] - Enumerar NFS             [8] -                                    #"
echo "# [4] - Enumerar SNMP            [9] -                                    #"
echo "# [5] -                          [10]-                                    # "
echo "###########################################################################"

echo -e "${GREEN}Selecione uma opcao...${END}"

    read -n2 -p 'opcao: ' respmenu

    case $respmenu in

##################################################################################
########## Enumerar SMB/NetBIOS - nbtscan | enum4linux
##################################################################################

1)  #Enumerar SMB/NetBIOS

    echo "[#] Enumerar SMB/NetBIOS"
    echo 
    echo "(1) - Scannear rede Nmap"
    echo "(2) - Scannear rede nbtscan"
    echo "(3) - Compartilhamentos disponiveis ${RED}(Autenticacao Null Session)${END}"
    echo "(4) - Compartilhamentos disponiveis ${RED}(Autenticacao com usuario e senha)${END}"
    echo "(5) - Scanner completo >> enum4linux"
    echo "(6) - VOLTAR AO MENU PRINCIPAL"
    
        read -n1 -p 'opcao: ' resp01

        case $resp01 in

            "1") # Scannear rede Nmap

                echo "Digite o CIDR/IP"
                echo
                echo "Exemplo1: 172.16.1.10" 
                echo "Exemplo2: 172.16.1.0/24"
                echo "Exemplo3: 172.16.1.100-200"
                read endereco01

                    nmap -v -sV -p 139,445 --open $endereco01 -Pn
            ;;

            "2") # Scannear rede nbtscan

                echo "Digite o endereco IP:"
                echo
                echo "Exemplo1: 172.16.1.10" 
                echo "Exemplo2: 172.16.1.0/24"
                echo "Exemplo3: 172.16.1.100-200"
                read endereco02

                    nbtscan -r $endereco02
            ;;

            "3") #Compartilhamentos disponiveis (Autenticacao Null Session)

                echo "Digite o endereco IP:"
                read endereco03

                    smbclient -L \\$endereco03 -N
            ;;

            "4") # Compartilhamentos disponiveis (Autenticacao com usuario e senha)

                echo "Digite o endereco IP:"
                read endereco04
                echo "Digite o nome de usuario:"
                read usuario04

                    smbclient -L \\$endereco04 -U $usuario04
            ;;

            "5") # Scanner completo >> enum4linux

                echo "Digite o endereco IP:"
                read endereco05
                echo "Digite o usuario (OPCIONAL)"
                read usuario05
                echo "Digite a senha (OPCIONAL)"
                read senha05

                    enum4linux -A -S -U $endereco05 -p $senha05 -u $usuario05
            ;;

            "6") # VOLTAR AO MENU PRINCIPAL
                

        esac
        ;;

##################################################################################
########## Enumerar RPC - rpcclient 139/445
##################################################################################

2) # Enumerar RPC

    echo "[#] Enumerar RPC - rpcclient"
    echo
    echo "Digite o endereco IP:"
    read endereco001
    echo "Digite o usuario (OPCIONAL)"
    read usuario002
    echo "Digite a senha (OPCIONAL)"
    read senha005

        if [["$usuario" == ""]]
        then

            rpccleint -U "" $senha005 $endereco001
        
        else

            rpccleint -U $usuario002 $endereco001
        
        fi
    
##################################################################################
########## Enumerar NFS - rpcinfo 139/445
##################################################################################        
            
3) # Enumerar NFS

    echo " [+] - Enumerar NFS - rpcinfo"
    echo
    echo "Digite o endereco IP:"
    read ip3

        echo "Checando as versoes suportadas:"

            rpcinfo -p $ip3 | grep nfs
        
        echo "Mais detalhes sobre o compartilhamento:"

            showmount -e $ip3
        
        echo "Deseja montar um compartilhamento do alvo ? n/y"
            read nfs1

            if [[ "$nfs1" == "n"]]
            then

                exit

            else

                echo "Informe a versao do NFS:"
                read nfs2
                echo "Informe o compartilhamento do NFS:"
                read path1

                    echo "Montando compartilhamento..."

                        mount -t nfs -o nfsvers=$nfs2 $ip3:$path1 /tmp/$ip3

            fi
        
##################################################################################
########## Enumerar SNMP - 161/UDP
##################################################################################         

4) # Enumerar SNMP
    
    # falta inserir a lista de communitys
    # Utilitarios usados: onesixtyone, snmpwalk, snmptranslate, snmp-check, snmpset

    echo " [+] - Enumerar SNMP - 161/UDP"
    echo
    echo " (1) - Scanear rede - Nmap"
    echo " (2) - Scanear rede - onesixtyone"
    echo " (3) - Enumerar host - snmp-check (Informacoes organizadas)"
    echo " (4) - Alterar dados - snmpset - Community Manager (permissao de escrita)"
    echo " (5) - Buscar por MIBS especificas no DB - snmptranslate"
    echo " (6) - Pesquisar tipos de MIBS"
    echo " (7) - Configurar snmp-mibs"

    read resp04
    case resp04 in

        "1") # Scanear Rede

            echo "Digite o CIDR/IP"
            echo
            echo "Exemplo1: 172.16.1.10" 
            echo "Exemplo2: 172.16.1.0/24"
            echo "Exemplo3: 172.16.1.100-200"
            read ip4
            
                nmap -sVU -p161 -Pn $ip4
        ;;

        "2") # Scanear rede com onesixtyone

            echo "Digite o CIDR/IP"
            echo
            echo "Exemplo1: 172.16.1.10" 
            echo "Exemplo2: 172.16.1.0/24"
            echo "Exemplo3: 172.16.1.100-200"
            read ip04
            echo "Informe a lista de communitys"
            read arquivo04

                echo "Realizando a varredura..."

                    onesixtyone -c $arquivos$arquivo04 $ip04

                echo "Enumeracao do Alvo - snmpwalk"
                echo
                echo "Informe a community:"
                echo "Exemplo: public"
                read community004
                echo "Informe o endereco Alvo:"
                read ip004
                echo "Informe a MIB (OPCIONAL)"
                read mib004

                    snmpwalk -c $community004 -v1 $ip004 $mib004
        ;;

        "3") # Enumerar host com snmp-check

            echo "Digite o endereco Alvo:"
            read ip0004
            echo "Informe a community"
            read community0004

                snmp-check $ip0004 -c $community0004
        ;;

        "4") # Alterar dados com snmpset - MIB Mananger


            echo "Informe o endereco Alvo:"
            read ip00004
            echo "Informe o nome da community:"
            read community00004
            echo "Informe a MIB a ser alterada:"
            read mib000004

                snmpset 
                echo "Comando: snmpset -c -v1 $ip00004 $mib000004 s " " "
        ;;

        "5") # Buscar por MIBS especificas no DB - snmptraslate

            echo "Informe o nome da MIB"
            read mib0004

                echo "Nome da MIB:"

                    snmptranslate -IR $mib0004

                echo "Mais detalhes da MIB"
                echo "Informe o nome da MIB:"
                read mib00004

                    snmptranslate -Td $mib00004
        ;;

        "6") # Pesquisar tipos de MIBS

            echo "Digite a funcao desejada:"
            echo
            echo "Exemplo: icmp "
            read funcao000004

                snmptranslate -TB $funcao000004

            echo "Informe o nome da funcao para mais detalhes:"
            read funcao0000004

                snmptranslate -Td $funcao0000004

        ;;

        "7") # Configurar snmp-mibs

            echo "Configurando..."

                sudo apt install snmp-mibs-downloader
                echo " " > /etc/snmp/snmp.conf

    esac        
    ;;            

    esac